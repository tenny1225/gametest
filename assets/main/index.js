System.register("chunks:///_virtual/Background.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(r){"use strict";var e,t,n,o,i,c,u,a,l;return{setters:[function(r){e=r.applyDecoratedDescriptor,t=r.inheritsLoose,n=r.initializerDefineProperty,o=r.assertThisInitialized},function(r){i=r.cclegacy,c=r._decorator,u=r.UITransform,a=r.Graphics,l=r.Component}],execute:function(){var s,f,p,d,h,g,y,b,m;i._RF.push({},"50884Dle2ZIoKMRQlryoFNU","Background",void 0);var z=c.ccclass,v=c.property;r("Background",(s=z("Background"),f=v(String),p=v(Boolean),d=v(Number),s((y=e((g=function(r){function e(){for(var e,t=arguments.length,i=new Array(t),c=0;c<t;c++)i[c]=arguments[c];return e=r.call.apply(r,[this].concat(i))||this,n(e,"color",y,o(e)),n(e,"isRound",b,o(e)),n(e,"roundSize",m,o(e)),e}t(e,r);var i=e.prototype;return i.start=function(){var r=this.getComponent(u),e=r.contentSize.width,t=r.contentSize.height,n=this.addComponent(a);n.fillColor.fromHEX(this.color),this.isRound?(n.roundRect(-e/2,-t/2,e,t,this.roundSize),n.fill()):n.fillRect(-e/2,-t/2,e,t)},i.update=function(r){},e}(l)).prototype,"color",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"#ffffff"}}),b=e(g.prototype,"isRound",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),m=e(g.prototype,"roundSize",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4}}),h=g))||h));i._RF.pop()}}}));

System.register("chunks:///_virtual/DataItem.ts",["cc"],(function(e){"use strict";var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){e({PropType:void 0,SpriteDirction:void 0}),t._RF.push({},"0eae8E+UQJEG7GSeyaTssE8","DataItem",void 0);var i,o;e("GrassItem",(function(){this.bg=void 0,this.prop=void 0,this.locked=void 0,this.direction=void 0}));!function(e){e.Left="l",e.Top="t",e.Right="r",e.Bottom="b"}(i||(i=e("SpriteDirction",{}))),function(e){e.Blank="blank",e.Grass="grass",e.Stone="stone",e.Fire="fire",e.Wind="wind",e.Sprite="sprite",e.Hole_Switch="hole_s",e.Hole_on="hole_on",e.Hole_off="hole_off",e.Radish="radish",e.Enemy="enemy",e.Fence_Left_Bottom="l_b",e.Fence_Right_Bottom="r_b",e.Fence_Left_Top="l_t",e.Fence_Right_Top="r_t"}(o||(o=e("PropType",{})));var n=e("Config",(function(){}));n.Grass_size=600/4.5,n.Lock_size=20,n.Sprite_size=40,t._RF.pop()}}}));

System.register("chunks:///_virtual/DialogManger.ts",["cc"],(function(t){"use strict";var e,n,i,o,a,r,s,l,c;return{setters:[function(t){e=t.cclegacy,n=t.UIOpacity,i=t.tween,o=t.v3,a=t.UITransform,r=t.instantiate,s=t.Label,l=t.NodeEventType,c=t.ParticleSystem2D}],execute:function(){e._RF.push({},"9a4bdZLYrdDrLPrNF4WFZaK","DialogManger",void 0);t("DialogManger",function(){function t(){this.parent=void 0,this.prefab=void 0,this.dialog=void 0,this.listener=void 0}t.create=function(e,n){var i=new t;return i.parent=e,i.prefab=n,i};var e=t.prototype;return e.onClosed=function(t){return this.listener=t,this},e.close=function(){var t=this,e=this.dialog.getChildByPath("content"),a=this.dialog.getComponent(n);return i(a).to(.2,{opacity:0},{onComplete:function(){t.dialog.removeFromParent(),t.parent=null,t.prefab=null,t.listener&&t.listener()}}).start().removeSelf(),i(e).to(.2,{scale:o(.3,.3,1)}).start().removeSelf(),this},e.show=function(t){var e=this,h=this.parent.getComponent(a);this.dialog=r(this.prefab),this.dialog.getComponent(a).setContentSize(h.contentSize);var g=this.dialog.getChildByPath("content"),d=g.getChildByPath("title").getComponent(s);d.string=t?"恭喜过关":"闯关失败",g.getChildByPath("restart").on(l.TOUCH_END,(function(){e.close()}));var p=this.dialog.addComponent(n);return p.opacity=0,this.dialog.parent=this.parent,i(p).to(.2,{opacity:255}).start().removeSelf(),i(g).set({scale:o(.1,.1,1)}).to(.3,{scale:o(1,1,1)},{easing:"smooth"}).delay(.2).call((function(){var n=e.dialog.getChildByPath("p2d").getComponent(c);t&&n.resetSystem()})).start().removeSelf(),this},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/Game.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DialogManger.ts"],(function(e){"use strict";var r,t,o,a,i,n,c,s,l;return{setters:[function(e){r=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){i=e.cclegacy,n=e._decorator,c=e.Prefab,s=e.Component},function(e){l=e.DialogManger}],execute:function(){var u,p,f,g,d,h;i._RF.push({},"a1cacOFLIZKK53oTegPf+I3","Game",void 0);var b=n.ccclass,y=n.property;e("Game",(u=b("Game"),p=y(c),u(((h=function(e){function r(){for(var r,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return r=e.call.apply(e,[this].concat(i))||this,o(r,"dialogPrefab",d,a(r)),r}t(r,e);var i=r.prototype;return i.gameOver=function(e){l.create(this.node,this.dialogPrefab).show(!1).onClosed(e)},i.win=function(e){l.create(this.node,this.dialogPrefab).show(!0).onClosed(e)},r}(s)).resources=new Map,d=r((g=h).prototype,"dialogPrefab",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=g))||f));i._RF.pop()}}}));

System.register("chunks:///_virtual/Grassland.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataItem.ts","./Game.ts","./Stage.ts"],(function(e){"use strict";var t,o,n,i,r,s,a,p,c,d,l,g,h,f,u,m,v,C,z,S,y;return{setters:[function(e){t=e.inheritsLoose,o=e.createForOfIteratorHelperLoose},function(e){n=e.cclegacy,i=e._decorator,r=e.Layers,s=e.v3,a=e.UITransform,p=e.UIOpacity,c=e.Size,d=e.v2,l=e.Sprite,g=e.Graphics,h=e.NodeEventType,f=e.Rect,u=e.tween,m=e.Node,v=e.Component},function(t){C=t.PropType,z=t.Config,e("PropType",t.PropType)},function(e){S=e.Game},function(e){y=e.Stage}],execute:function(){var T;n._RF.push({},"fe1e47CB0JBZbl83va1MzMs","Grassland",void 0);var L=i.ccclass;i.property,e("Grassland",L("Grassland")(T=function(e){function n(){for(var t,o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return(t=e.call.apply(e,[this].concat(n))||this).prop=void 0,t.isLock=void 0,t.isBlank=void 0,t.size=void 0,t.spriteMoveCentered=new Map,t}t(n,e);var i=n.prototype;return i.init=function(e,t,o,n){this.prop=n.prop,this.isLock=n.locked,this.size=o,this.node.layer=r.Enum.ALL,this.node.setPosition(s(e,t,0));var i=this.addComponent(a);if(this.addComponent(p),i.setContentSize(new c(o,o)),i.setAnchorPoint(d(.5,.5)),n.bg!=C.Blank){var h=this.addComponent(l);h.sizeMode=0,h.spriteFrame=S.resources.get("grass"+Math.floor(4*Math.random())),this.node.addComponent(g),this.addTouchEvent(),this.showLock(),this.showProp()}else this.isBlank=!0},i.toggleBorder=function(e){},i.removeTouchEvent=function(){this.node.off(h.TOUCH_START),this.node.off(h.TOUCH_MOVE),this.node.off(h.TOUCH_END),this.node.off(h.TOUCH_CANCEL)},i.addTouchEvent=function(){var e=this;if(!this.isLock){var t=null;this.node.on(h.TOUCH_START,(function(n){if(!e.isLock){var i=n.target,r=i.parent.getComponent(y);r.gamePause();for(var s,a=o(r.enemies.concat([r.spriteManager]));!(s=a()).done;){var c=s.value,d=c.node.getWorldPosition(),l=i.getWorldPosition(),g=new f(d.x-c.size/2,d.y-r.spriteManager.size/2,c.size,c.size);if(new f(l.x-c.parentSize/2,l.y-c.parentSize/2,c.parentSize,c.parentSize).intersects(g))return r.gameContinue(),r.warn(),void(t=null)}t=n.target.position.clone(),i.removeFromParent(),r.node.addChild(i),e.getComponent(p).opacity=200}})),this.node.on(h.TOUCH_MOVE,(function(i){if(!e.isLock&&null!=t){var r=i.target,s=i.getUIStartLocation(),p=i.getUILocation(),c=t.clone();c.x+=p.x-s.x,c.y+=p.y-s.y,r.setPosition(c),c=i.target.getComponent(a).getBoundingBoxToWorld();for(var l=i.target.parent.getComponent(y),g=0;g<l.cells.length;g++){var h=l.cells[g],u=h.getComponent(n);if(h!=e.node){if(h.getComponent(a).getBoundingBoxToWorld().contains(d(c.x+c.width/2,c.y+c.height/2))){for(var m,v=!1,C=o(l.enemies.concat([l.spriteManager]));!(m=C()).done;){var z=m.value,S=z.node.getWorldPosition(),T=h.getWorldPosition(),L=new f(S.x-z.size/2,S.y-z.size/2,z.size,z.size);if(new f(T.x-z.parentSize/2,T.y-z.parentSize/2,z.parentSize,z.parentSize).intersects(L)){v=!0;break}}if(!v){u.toggleBorder(!0);continue}}u.toggleBorder(!1)}}}})),this.node.on(h.TOUCH_END,(function(i){if(e.getComponent(p).opacity=255,!e.isLock&&null!=t){var r=i.target.getComponent(a).getBoundingBoxToWorld(),s=i.target.parent.getComponent(y);s.gameContinue();for(var c=0;c<s.cells.length;c++){var l=s.cells[c],g=l.getComponent(n);if(g.toggleBorder(!1),l!=e.node&&!g.isLock&&!g.isBlank)if(l.getComponent(a).getBoundingBoxToWorld().contains(d(r.x+r.width/2,r.y+r.height/2))){for(var h,m=!1,v=o(s.enemies.concat([s.spriteManager]));!(h=v()).done;){var C=h.value,z=C.node.getWorldPosition(),S=l.getWorldPosition(),T=new f(z.x-C.size/2,z.y-C.size/2,C.size,C.size);if(new f(S.x-C.parentSize/2,S.y-C.parentSize/2,C.parentSize,C.parentSize).intersects(T)){s.warn(),m=!0;break}}if(m)break;var L=l.position.clone();u(l).to(.1,{position:t}).start().removeSelf(),u(i.target).to(.1,{position:L}).start().removeSelf();var w=s.cells.indexOf(i.target);return s.cells[c]=i.target,void(s.cells[w]=l)}}u(i.target).to(.1,{position:t}).start().removeSelf()}})),this.node.on(h.TOUCH_CANCEL,(function(o){e.getComponent(p).opacity=255,e.isLock||null==t||u(o.target).to(.1,{position:t}).start().removeSelf()}))}},i.showLock=function(){if(this.isLock){var e=new m,t=e.addComponent(a);t.addComponent(p).opacity=150;var o=z.Grass_size;t.setContentSize(new c(o,o)),t.setAnchorPoint(.5,.5);var n=e.addComponent(l);n.sizeMode=l.SizeMode.CUSTOM,n.spriteFrame=S.resources.get("lock"),this.node.addChild(e)}},i.showProp=function(){var e=new m,t=e.addComponent(a),o=z.Sprite_size;t.setAnchorPoint(.5,.5);var n=e.addComponent(l);n.sizeMode=l.SizeMode.CUSTOM,this.prop==C.Stone?n.spriteFrame=S.resources.get("stone"):this.prop==C.Fence_Left_Bottom?(o=this.size-20,n.spriteFrame=S.resources.get("fence")):this.prop==C.Fence_Left_Top?(o=this.size-20,e.setRotationFromEuler(s(180,0,0)),n.spriteFrame=S.resources.get("fence")):this.prop==C.Fence_Right_Top?(o=this.size-20,e.setRotationFromEuler(s(180,180,0)),n.spriteFrame=S.resources.get("fence")):this.prop==C.Fence_Right_Bottom?(o=this.size-20,e.setRotationFromEuler(s(0,180,0)),n.spriteFrame=S.resources.get("fence")):this.prop==C.Radish&&(n.spriteFrame=S.resources.get("radish")),t.setContentSize(new c(o,o)),this.node.addChild(e)},n}(v))||T);n._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./DataItem.ts","./Game.ts","./Grassland.ts","./SprteManger.ts","./Stage.ts","./Background.ts","./DialogManger.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/SprteManger.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataItem.ts","./Game.ts","./Grassland.ts"],(function(i){"use strict";var t,e,s,o,n,r,h,a,d,c,p,g,u,f,v;return{setters:[function(i){t=i.inheritsLoose,e=i.createForOfIteratorHelperLoose,s=i.createClass},function(i){o=i.cclegacy,n=i.UITransform,r=i.Size,h=i.Sprite,a=i.v3,d=i.tween,c=i.Component},function(i){p=i.SpriteDirction,g=i.PropType,u=i.Config},function(i){f=i.Game},function(i){v=i.Grassland}],execute:function(){o._RF.push({},"d979e9pyTFDeb4O1OHLSdyR","SprteManger",void 0);i("SpriteManager",function(i){function o(){for(var t,e=arguments.length,s=new Array(e),o=0;o<e;o++)s[o]=arguments[o];return(t=i.call.apply(i,[this].concat(s))||this).paused=!0,t.parentSize=void 0,t.size=u.Sprite_size,t.stage=void 0,t.grass=void 0,t.isInvincible=!1,t.isEnemy=void 0,t.spriteDefaultDirection=p.Top,t.direc=void 0,t}t(o,i);var c=o.prototype;return c.addTo=function(i,t,e){void 0===e&&(e=!1),this.stage=i,this.direction=t,this.isEnemy=e,e?i.enemies.push(this):i.spriteManager=this;var s=this.node.addComponent(n);s.setContentSize(new r(this.size,this.size)),s.setAnchorPoint(.5,.5);var o=this.addComponent(h);o.sizeMode=h.SizeMode.CUSTOM,this.isEnemy?o.spriteFrame=f.resources.get("enemy"):o.spriteFrame=f.resources.get("sprite")},c.setPosition=function(i,t,e){if(void 0===e&&(e=!1),this.node.removeFromParent(),this.stage.node.addChild(this.node),e)this.node.setPosition(a(i,t,0));else{var s=this.grass.node.position;this.node.setPosition(a(i+s.x,t+s.y,0))}},c.setParent=function(i){if(!this.grass||this.grass.node!=i){this.grass=i.getComponent(v),this.isMoveCenter=!1;var t=i.getComponent(n);this.parentSize=t.contentSize.width,this.node.removeFromParent(),this.stage.node.addChild(this.node)}},c.pause=function(){this.paused=!0},c.continue=function(){var i=this.node.parent.parent;this.node.parent.removeFromParent(),i.addChild(this.node.parent),this.paused=!1},c.isEatByEnemy=function(){for(var i,t=this.getComponent(n).getBoundingBoxToWorld(),s=e(this.stage.enemies);!(i=s()).done;){var o=i.value.getComponent(n).getBoundingBoxToWorld();if(t.intersects(o))return!0}return!1},c.isTouchBorder=function(){var i=this.node.position,t=i.x,e=i.y;this.direction==p.Top?e+=this.size:this.direction==p.Bottom?e-=this.size:this.direction==p.Left?t-=this.size:this.direction==p.Right&&(t+=this.size);var s=this.grass.node.position;return Math.abs(Math.floor(t-s.x))<=2&&Math.abs(Math.floor(e-s.y))<=2},c.isTouchCenter=function(){var i=this.node.position,t=this.grass.node.position;return Math.abs(Math.floor(i.x-t.x))<=2&&Math.abs(Math.floor(i.y-t.y))<=2},c.update=function(i){var t=this;if(!this.paused){if(!this.isEnemy&&this.isEatByEnemy())return this.pause(),void this.stage.gameOver();var e=this.node.position,s=this.grass.node.position,o=1.3,n=this.stage.getGrassNav(this.grass.node);if(this.direction==p.Left)if(this.setPosition(e.x-o,e.y,!0),e=this.node.position,-1!=n[0]){if(e.x<=s.x-this.parentSize/2){var r=this.stage.cells[n[0]];this.setParent(r),this.setPosition(this.parentSize/2+this.stage.grass_spcae,0)}}else e.x-this.size/2<=s.x-this.parentSize/2&&(this.direction=p.Right,this.isMoveCenter=!1);else if(this.direction==p.Top)if(this.setPosition(e.x,e.y+o,!0),e=this.node.position,-1!=n[1]){if(e.y>=s.y+this.parentSize/2){var h=this.stage.cells[n[1]];this.setParent(h),this.setPosition(0,-this.parentSize/2-this.stage.grass_spcae)}}else e.y+this.size/2>=s.y+this.parentSize/2&&(this.direction=p.Bottom,this.isMoveCenter=!1);else if(this.direction==p.Right)if(this.setPosition(e.x+o,e.y,!0),e=this.node.position,-1!=n[2]){if(e.x>=s.x+this.parentSize/2){var c=this.stage.cells[n[2]];this.setParent(c),this.setPosition(-this.parentSize/2-this.stage.grass_spcae,0)}}else e.x+this.size/2>=s.x+this.parentSize/2&&(this.direction=p.Left,this.isMoveCenter=!1);else if(this.direction==p.Bottom)if(this.setPosition(e.x,e.y-o,!0),e=this.node.position,-1!=n[3]){if(e.y<=s.y-this.parentSize/2){var u=this.stage.cells[n[3]];this.setParent(u),this.setPosition(0,this.parentSize/2+this.stage.grass_spcae)}}else e.y-this.size/2<=s.y-this.parentSize/2&&(this.direction=p.Top,this.isMoveCenter=!1);if(!this.isInvincible&&!this.isMoveCenter&&this.grass.prop!=g.Blank)if(this.grass.prop==g.Fence_Left_Bottom)this.direction==p.Left&&this.isTouchBorder()?(this.direction=p.Right,this.isMoveCenter=!0):this.direction==p.Right&&this.isTouchCenter()?(this.direction=p.Bottom,this.isMoveCenter=!0,this.setPosition(0,0)):this.direction==p.Top&&this.isTouchBorder()?(this.direction=p.Left,this.isMoveCenter=!0,this.setPosition(0,0)):this.direction==p.Bottom&&this.isTouchCenter()&&(this.direction=p.Top,this.isMoveCenter=!0);else if(this.grass.prop==g.Fence_Left_Top)this.direction==p.Right&&this.isTouchCenter()?(this.direction=p.Top,this.isMoveCenter=!0,this.setPosition(0,0)):this.direction==p.Left&&this.isTouchBorder()?(this.direction=p.Right,this.isMoveCenter=!0):this.direction==p.Top&&this.isTouchBorder()?(this.direction=p.Bottom,this.isMoveCenter=!0):this.direction==p.Bottom&&this.isTouchCenter()&&(this.direction=p.Left,this.isMoveCenter=!0,this.setPosition(0,0));else if(this.grass.prop==g.Fence_Right_Bottom)this.direction==p.Left&&this.isTouchCenter()?(this.direction=p.Bottom,this.isMoveCenter=!0,this.setPosition(0,0)):this.direction==p.Right&&this.isTouchBorder()?(this.direction=p.Left,this.isMoveCenter=!0):this.direction==p.Top&&this.isTouchCenter()?(this.direction=p.Right,this.isMoveCenter=!0,this.setPosition(0,0)):this.direction==p.Bottom&&this.isTouchBorder()&&(this.direction=p.Top,this.isMoveCenter=!0);else if(this.grass.prop==g.Fence_Right_Top)this.direction==p.Left&&this.isTouchCenter()?(this.direction=p.Top,this.isMoveCenter=!0,this.setPosition(0,0)):this.direction==p.Right&&this.isTouchBorder()?(this.direction=p.Left,this.isMoveCenter=!0):this.direction==p.Top&&this.isTouchBorder()?(this.direction=p.Bottom,this.isMoveCenter=!0):this.direction==p.Bottom&&this.isTouchCenter()&&(this.direction=p.Right,this.isMoveCenter=!0,this.setPosition(0,0));else if(this.grass.prop==g.Wind&&this.isTouchBorder()){this.isMoveCenter=!0;var f=2*this.parentSize/78;this.isInvincible=!0,d(this.node).to(.3,{scale:a(1.8,1.8,1)}).to(f-.3,{scale:a(1,1,1)},{onComplete:function(){t.isInvincible=!1}}).start().removeSelf()}else(this.grass.prop==g.Stone||this.isEnemy&&this.grass.prop==g.Radish)&&this.isTouchBorder()?(this.isMoveCenter=!0,this.direction==p.Left?this.direction=p.Right:this.direction==p.Right?this.direction=p.Left:this.direction==p.Top?this.direction=p.Bottom:this.direction==p.Bottom&&(this.direction=p.Top)):this.grass.prop!=g.Fire&&this.grass.prop!=g.Hole_on||!this.isTouchBorder()?this.grass.prop==g.Radish&&this.isTouchBorder()&&(this.isMoveCenter=!0,this.stage.win()):(this.isMoveCenter=!0,this.stage.gameOver())}},s(o,[{key:"isMoveCenter",get:function(){return this.grass.spriteMoveCentered.get(this.uuid)},set:function(i){this.grass.spriteMoveCentered.set(this.uuid,i)}},{key:"direction",get:function(){return this.direc},set:function(i){var t=a(0,0,0);i==p.Right?t.z=-90:i==p.Top?t.z=0:i==p.Bottom?t.z=180:i==p.Left&&(t.z=90),this.node.setRotationFromEuler(t),this.direc=i}}]),o}(c));o._RF.pop()}}}));

System.register("chunks:///_virtual/Stage.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataItem.ts","./Game.ts","./Grassland.ts","./SprteManger.ts"],(function(e){"use strict";var t,a,n,s,r,o,i,c,h,l,u,d,v,g,f,p,m;return{setters:[function(e){t=e.inheritsLoose,a=e.createForOfIteratorHelperLoose},function(e){n=e.cclegacy,s=e._decorator,r=e.UITransform,o=e.resources,i=e.SpriteFrame,c=e.assetManager,h=e.Node,l=e.tween,u=e.v3,d=e.Component},function(e){v=e.PropType,g=e.Config},function(e){f=e.Game},function(e){p=e.Grassland},function(e){m=e.SpriteManager}],execute:function(){var S;n._RF.push({},"44196sIBgxPAqiyY5vatggL","Stage",void 0);var M=s.ccclass;s.property,e("Stage",M("Stage")(S=function(e){function n(){for(var t,a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return(t=e.call.apply(e,[this].concat(n))||this).game=void 0,t.cells=void 0,t.data=void 0,t.stageWidth=void 0,t.stageHeight=void 0,t.spriteManager=void 0,t.enemies=[],t.grass_spcae=2,t}t(n,e);var s=n.prototype;return s.start=function(){this.game=this.node.parent.getComponent(f);var e=this.getComponent(r),t=e.contentSize.width,a=e.contentSize.height;this.stageWidth=t,this.stageHeight=a,this.showStage()},s.showStage=function(){var e=this;o.loadDir("./",(function(t,n){for(var s,r=a(n);!(s=r()).done;){var o=s.value;o instanceof i&&f.resources.set(o.name,o)}c.loadBundle("conf",(function(t,a){a.load("out",(function(t,a){e.data=a.json,c.loadBundle("res",(function(){e.createMap()}))}))}))}))},s.createMap=function(){var e=this.data.length,t=this.data[0].length,a=g.Grass_size;this.cells=[],this.enemies=[],this.spriteManager=null;for(var n=t*a/2-a/2,s=e*a/2-a/2,r=0;r<e;r++)for(var o=0;o<t;o++)this.initGrass(this.data[r][o],a,o*a-n,s-r*a)},s.initGrass=function(e,t,a,n){t-=this.grass_spcae;var s=new h;this.node.addChild(s),s.addComponent(p).init(a,n,t,e),this.cells.push(s);if(l(s).set({scale:u(0,0,0)}).to(.2,{scale:u(1,1,1)}).start().removeSelf(),e.prop==v.Sprite){var r=new h,o=r.addComponent(m);o.addTo(this,e.direction),o.setParent(s),o.setPosition(0,0),l(r).set({scale:u(0,0,0)}).to(.2,{scale:u(1,1,1)}).delay(.2).start().removeSelf()}else if(e.prop==v.Enemy){var i=new h,c=i.addComponent(m);c.addTo(this,e.direction,!0),c.setParent(s),c.setPosition(0,0),l(i).set({scale:u(0,0,0)}).to(.3,{scale:u(1,1,1)}).delay(.2).start().removeSelf()}},s.getGrassNav=function(e){var t=this.data.length,a=this.data[0].length,n=this.cells.indexOf(e),s=n%a,r=Math.floor(n/a),o=-1;s-1>=0&&this.data[r][s-1].bg!=v.Blank&&(o=n-1);var i=-1;r-1>=0&&this.data[r-1][s].bg!=v.Blank&&(i=n-a);var c=-1;s+1<a&&this.data[r][s+1].bg!=v.Blank&&(c=n+1);var h=-1;return r+1<t&&this.data[r+1][s].bg!=v.Blank&&(h=n+a),[o,i,c,h]},s.warn=function(){},s.gameOver=function(){var e=this;this.gamePause();for(var t,n=a(this.cells);!(t=n()).done;){t.value.getComponent(p).removeTouchEvent()}this.game.gameOver((function(){e.restart()}))},s.win=function(){var e=this;this.gamePause();for(var t,n=a(this.cells);!(t=n()).done;){t.value.getComponent(p).removeTouchEvent()}this.game.win((function(){e.restart()}))},s.gameContinue=function(){this.spriteManager.continue();for(var e,t=a(this.enemies);!(e=t()).done;){e.value.continue()}},s.gamePause=function(){this.spriteManager.pause();for(var e,t=a(this.enemies);!(e=t()).done;){e.value.pause()}},s.restart=function(){for(var e,t=a(this.cells);!(e=t()).done;){e.value.removeFromParent()}for(var n,s=a(this.enemies.concat([this.spriteManager]));!(n=s()).done;){n.value.node.removeFromParent()}this.createMap()},n}(d))||S);n._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});